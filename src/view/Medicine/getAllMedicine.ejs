<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>All Medicines</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="/css/style.css" />
    <style>
        body {
            margin-top: 80px;
            padding-left: 260px;
            overflow-x: hidden;
        }

        #searchInput {
            max-width: 300px;
        }
    </style>
</head>

<body>

    <!-- Dynamically include navbar and sidebar based on role -->
    <% if (session.user && session.user.role==='doctor' ) { %>
        <%- include('../Doctor/doctorNavbar') %>
            <%- include('../Doctor/doctorSidebar') %>
                <% } else if (session.user && session.user.role==='receptionist' ) { %>
                    <%- include('../Reception/receptionNavbar') %>
                        <%- include('../Reception/receptionSidebar') %>
                            <% } else { %>
                                <%- include('../navbar') %>
                                    <% } %>

                                        <div class="container">

                                            <!-- Title, Add button and Search in one row -->
                                            <div class="row mb-3 align-items-center">
                                                <div class="col">
                                                    <h2 class="mb-0">All Medicines</h2>
                                                </div>
                                                <div class="col-auto">
                                                    <input type="text" id="searchInput" onkeyup="searchMedicine()"
                                                        class="form-control" placeholder="Search medicine by name...">
                                                </div>
                                                <div class="col-auto">
                                                    <a href="/medicine/add-medicine" class="btn btn-primary">+ Add
                                                        Medicine</a>
                                                </div>
                                            </div>

                                            <!-- Medicines Table -->
                                            <table class="table table-bordered table-hover shadow-sm">
                                                <thead class="table-dark">
                                                    <tr>
                                                        <th>Medicine Name</th>
                                                        <th>Price (₹)</th>
                                                        <th style="width: 160px;">Actions</th>
                                                    </tr>
                                                </thead>
                                                <tbody id="medicineTable">
                                                    <% medicines.forEach(medicine=> { %>
                                                        <tr>
                                                            <td>
                                                                <%= medicine.medicine_name %>
                                                            </td>
                                                            <td>₹ <%= medicine.price_medicine %>
                                                            </td>
                                                            <td>
                                                                <a href="/medicine/update-medicine/<%= medicine.medical_id %>"
                                                                    class="btn btn-sm btn-warning">Edit</a>
                                                                <a href="/medicine/delete-medicine/<%= medicine.medical_id %>"
                                                                    class="btn btn-sm btn-danger">Delete</a>
                                                            </td>
                                                        </tr>
                                                        <% }) %>
                                                </tbody>
                                            </table>

                                        </div>

                                        <%- include('../fotter') %>

                                            <script>
                                                function searchMedicine() {
                                                    const input = document.getElementById("searchInput");
                                                    const filter = input.value.toLowerCase();
                                                    const table = document.getElementById("medicineTable");
                                                    const tr = table.getElementsByTagName("tr");

                                                    for (let i = 0; i < tr.length; i++) {
                                                        const td = tr[i].getElementsByTagName("td")[0];
                                                        if (td) {
                                                            const txtValue = td.textContent || td.innerText;
                                                            tr[i].style.display = txtValue.toLowerCase().includes(filter) ? "" : "none";
                                                        }
                                                    }
                                                }
                                            </script>

                                            <script
                                                src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

</body>

</html>